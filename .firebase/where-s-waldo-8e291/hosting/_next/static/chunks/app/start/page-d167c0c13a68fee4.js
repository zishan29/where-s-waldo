(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[670],{445:function(e,t,a){Promise.resolve().then(a.bind(a,5237))},5237:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return h}});var s=a(7437),n=a(2265),o=a(6691),r=a.n(o),i=e=>{let{characters:t,handleItemClick:a,menuState:n,isBlurred:o}=e,i=t.filter(e=>!o[e.name]),l=(()=>{if(n.isOpen){let e=window.innerWidth,t=window.innerHeight,a={top:n.position.y+window.scrollY,left:n.position.x+window.scrollX};return n.position.x+200>e+window.scrollX-20&&(a.left=Math.max(window.scrollX+20,e-200+window.scrollX-20,n.position.x-200+window.scrollX)),n.position.y+200+window.scrollY>t+window.scrollY-20&&(a.top=Math.max(window.scrollY+20,t-200+window.scrollY-20)),a}return null})(),c=e=>{if(null!==e){if("Zoro"===e)return"https://firebasestorage.googleapis.com/v0/b/where-s-waldo-8e291.appspot.com/o/Zoro.png?alt=media&token=cb7648b6-660d-435b-91d5-0c1e81cba135";if("Law"===e)return"https://firebasestorage.googleapis.com/v0/b/where-s-waldo-8e291.appspot.com/o/Law.png?alt=media&token=ea6e57d5-4e71-41da-8338-47baa3349bd8";if("Hancock"===e)return"https://firebasestorage.googleapis.com/v0/b/where-s-waldo-8e291.appspot.com/o/Hancock.png?alt=media&token=115303f5-7fa6-459b-9b81-864cca8f7160"}};return(0,s.jsx)(s.Fragment,{children:n.isOpen&&(0,s.jsx)("div",{className:"absolute z-10",style:l||void 0,children:(0,s.jsx)("div",{className:"transform rounded-md  bg-stone-900 transition",children:i.map(e=>(0,s.jsxs)("div",{onClick:()=>a(e._id),className:"flex cursor-pointer items-center gap-2 p-4 text-white",children:[(0,s.jsx)(r(),{src:c(e.name),alt:"".concat(e.name),width:40,height:40,priority:!0,className:"rounded"}),e.name]},e._id))})})})},l=function(){for(var e,t,a=0,s="",n=arguments.length;a<n;a++)(e=arguments[a])&&(t=function e(t){var a,s,n="";if("string"==typeof t||"number"==typeof t)n+=t;else if("object"==typeof t){if(Array.isArray(t)){var o=t.length;for(a=0;a<o;a++)t[a]&&(s=e(t[a]))&&(n&&(n+=" "),n+=s)}else for(s in t)t[s]&&(n&&(n+=" "),n+=s)}return n}(e))&&(s&&(s+=" "),s+=t);return s};let c=e=>{let{isBlurred:t,src:a,alt:n}=e;return(0,s.jsx)("div",{className:"".concat(t?"brightness-50 filter":""),children:(0,s.jsx)(r(),{src:a,alt:n,width:40,height:40,priority:!0,className:"rounded"})})},d=e=>{let{name:t,isBlurred:a}=e;return(0,s.jsx)("div",{className:"".concat(a?"line-through":""),children:t})};function m(e){let{characters:t,isBlurred:a,timer:o,setTimer:r,gameEnded:i}=e;return(0,n.useEffect)(()=>{let e;return i||(e=setInterval(()=>{r(e=>e+10)},10)),()=>clearInterval(e)},[i,r]),(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("nav",{className:l("sticky top-0 z-10 flex h-20 w-screen items-center bg-stone-900 px-8 text-white",{"brightness-50":i}),children:[(0,s.jsxs)("a",{href:"/",className:"cursor-pointer rounded-md px-3 py-2 text-2xl font-medium hover:bg-stone-800",children:["Pirate",(0,s.jsx)("span",{className:"text-yellow-400",children:"Hunt"})]}),(0,s.jsxs)("div",{className:"ml-5 flex items-center gap-4 px-2",children:[(0,s.jsx)(c,{src:"https://firebasestorage.googleapis.com/v0/b/where-s-waldo-8e291.appspot.com/o/Zoro.png?alt=media&token=cb7648b6-660d-435b-91d5-0c1e81cba135",alt:"Zoro",isBlurred:a.Zoro}),(0,s.jsx)(d,{name:"Zoro",isBlurred:a.Zoro}),(0,s.jsx)(c,{src:"https://firebasestorage.googleapis.com/v0/b/where-s-waldo-8e291.appspot.com/o/Law.png?alt=media&token=ea6e57d5-4e71-41da-8338-47baa3349bd8",alt:"Law",isBlurred:a.Law}),(0,s.jsx)(d,{name:"Law",isBlurred:a.Law}),(0,s.jsx)(c,{src:"https://firebasestorage.googleapis.com/v0/b/where-s-waldo-8e291.appspot.com/o/Hancock.png?alt=media&token=115303f5-7fa6-459b-9b81-864cca8f7160",alt:"Hancock",isBlurred:a.Hancock}),(0,s.jsx)(d,{name:"Hancock",isBlurred:a.Hancock})]}),t&&(0,s.jsx)("div",{className:"ml-auto",children:"".concat(String(Math.floor(o/6e4)).padStart(2,"0"),":").concat(String(Math.floor(o%6e4/1e3)).padStart(2,"0"),":").concat(String(o%1e3).padStart(3,"0"))})]})})}var p=a(4033);function u(e){let{gameEnded:t,timer:a}=e,[o,r]=(0,n.useState)(""),i=(0,p.useRouter)();async function l(){let e={name:o,time:c()};try{(await fetch("https://wheres-waldo-api.adaptable.app/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok&&i.push("/leaderboard")}catch(e){console.log(e)}}let c=()=>{let e="".concat(String(a%1e3).padStart(3,"0"));return"".concat("".concat(60*Math.floor(a/6e4)+Math.floor(a%6e4/1e3)),".").concat(e)};return(0,s.jsx)(s.Fragment,{children:t&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:"fixed inset-0 flex flex-col items-center justify-center",children:(0,s.jsxs)("div",{className:"rounded-md bg-stone-900 p-4",children:[(0,s.jsxs)("div",{className:"text-lg font-medium text-white",children:["You finished in ",c(),"s!"]}),(0,s.jsx)("div",{className:" mb-3 text-sm text-gray-300",children:"Submit your score to the leaderboard"}),(0,s.jsxs)("form",{action:"",className:"flex flex-col gap-2",children:[(0,s.jsx)("label",{htmlFor:"name",className:"block text-gray-300",children:"Username"}),(0,s.jsx)("input",{type:"text",id:"name",className:"h-10 rounded-md border border-stone-300 bg-transparent px-1 text-gray-300",onChange:e=>r(e.target.value)}),(0,s.jsx)("button",{type:"button",className:"h-10 transform self-start rounded-md bg-yellow-400 px-4 font-semibold text-gray-900 transition hover:bg-yellow-300 active:bg-yellow-500",onClick:()=>l(),children:"Submit"})]})]})})})})}function h(){let[e,t]=(0,n.useState)([]),[a,o]=(0,n.useState)(!1),[c,d]=(0,n.useState)({isOpen:!1,position:{x:0,y:0}}),[p,h]=(0,n.useState)(null),[f,g]=(0,n.useState)({}),[x,b]=(0,n.useState)(0),[w,y]=(0,n.useState)(0),[j,v]=(0,n.useState)(!1),[k,N]=(0,n.useState)(null);(0,n.useEffect)(()=>{(async()=>{try{let e=await fetch("https://wheres-waldo-api.adaptable.app/characters");if(e.ok){let a=await e.json();t(a.data)}}catch(e){console.log(e)}})()},[]),(0,n.useEffect)(()=>{if(a){let e=()=>{o(!1),d({isOpen:!1,position:{x:0,y:0}})};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}}},[a]),(0,n.useEffect)(()=>{3===x&&v(!0)},[x,v]),(0,n.useEffect)(()=>(j?document.body.classList.add("game-ended"):document.body.classList.remove("game-ended"),()=>{document.body.classList.remove("game-ended")}),[j]);let S=e=>{N(e),setTimeout(()=>{N(null)},3e3)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m,{characters:e,isBlurred:f,timer:w,setTimer:y,gameEnded:j}),(0,s.jsx)("div",{className:l("relative flex h-screen items-start justify-center bg-page-yellow",{"brightness-50":j}),children:(0,s.jsx)(r(),{src:"https://firebasestorage.googleapis.com/v0/b/where-s-waldo-8e291.appspot.com/o/onepiece.png?alt=media&token=4574a1c6-1fc7-4d62-aaa8-fa2ffbf87daf",alt:"",width:2e3,height:2e3,className:"cursor-crosshair",onClick:t=>{let a=t.target.getBoundingClientRect(),s=(t.clientX-a.left)/a.width*100,n=(t.clientY-a.top)/a.height*100;e.map(e=>{let{topLeft:t,bottomRight:a}=e.boundingBox;null!==t.x&&null!==t.y&&null!==a.x&&null!==a.y&&s>=t.x&&s<=a.x&&n>=t.y&&n<=a.y&&h(e)}),o(!0),d({isOpen:!0,position:{x:t.clientX,y:t.clientY}})},priority:!0})}),(0,s.jsx)(i,{characters:e,handleItemClick:function(e){null!==p&&p._id===e?(S("You found ".concat(p.name,"!")),g(e=>({...e,[p.name]:!0})),b(e=>e+1)):S("Try again!"),a&&d({isOpen:!1,position:{x:0,y:0}})},menuState:c,isBlurred:f}),(0,s.jsx)(u,{gameEnded:j,timer:w}),k&&(0,s.jsx)("div",{className:"fixed left-1/2 top-32 z-10 -translate-x-1/2 transform rounded bg-stone-900 px-4 py-2 text-white",children:k})]})}},4033:function(e,t,a){e.exports=a(5313)}},function(e){e.O(0,[986,971,938,744],function(){return e(e.s=445)}),_N_E=e.O()}]);